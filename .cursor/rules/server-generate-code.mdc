---
description: 
globs: 
alwaysApply: false
---
## Life Toolkit Serverå·¥å‚æ¨¡å¼ä»£ç ç”Ÿæˆè§„åˆ™

### ğŸ“‹ æ ¸å¿ƒå­—æ®µç±»å‹å®šä¹‰
```typescript
// æ”¯æŒçš„å­—æ®µç±»å‹
type FieldType = "string" | "number" | "boolean" | "Date" | "enum" | "object" | "array"

// å­—æ®µä¿¡æ¯ç»“æ„
interface FieldInfo {
  entityName: string;      // å®ä½“åç§°ï¼ˆæ”¯æŒåµŒå¥—è·¯å¾„ï¼Œå¦‚ user/profileï¼‰
  fieldName: string;       // å­—æ®µåç§°
  fieldType: FieldType;    // å­—æ®µç±»å‹
  isNullable: boolean;     // æ˜¯å¦å¯ç©º
  description: string;     // å­—æ®µæè¿°
  enumValues?: string[];   // æšä¸¾å€¼ï¼ˆä»…å½“ç±»å‹ä¸º enum æ—¶ï¼‰
}
```

### ğŸ—ï¸ é¡¹ç›®ç»“æ„çº¦å®š
```
apps/server/src/business/{module}/
â”œâ”€â”€ entities/{entity}.entity.ts     # TypeORM å®ä½“æ–‡ä»¶
â”œâ”€â”€ dto/                           # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”œâ”€â”€ {entity}.dto.ts           # åŸºç¡€ DTO ç±»
â”‚   â””â”€â”€ {entity}-filter.dto.ts    # è¿‡æ»¤å™¨ DTO ç±»
â””â”€â”€ mapper/{entity}.mapper.ts      # å¯¹è±¡æ˜ å°„æ–‡ä»¶

packages/vo/{module}/
â””â”€â”€ {entity}-model.vo.ts           # å€¼å¯¹è±¡æ¥å£æ–‡ä»¶
```

### ğŸ”§ Entity æ–‡ä»¶æ›´æ–°è§„åˆ™

#### TypeORM è£…é¥°å™¨æ˜ å°„
```typescript
const TYPE_DECORATORS: Record<FieldType, string> = {
  string: "@Column('varchar')",
  number: "@Column('int')",
  boolean: "@Column('boolean')",
  Date: '@Column("datetime")',
  enum: '@Column({ type: "enum", enum: {EnumType} })',
  object: '@Column("json")',
  array: '@Column("simple-array")',
}

const VALIDATOR_DECORATORS: Record<FieldType, string> = {
  string: "@IsString()",
  number: "@IsNumber()",
  boolean: "@IsBoolean()",
  Date: "@IsDate()",
  enum: "@IsEnum({EnumType})",
  object: "@IsObject()",
  array: "@IsArray()",
}
```

#### Entity å­—æ®µç”Ÿæˆæ¨¡æ¿
```typescript
// å­—æ®µå®šä¹‰æ¨¡æ¿
/** {description} */
{typeDecorator}
{nullableDecorator}  // @IsOptional() å¦‚æœ isNullable ä¸º true
{validatorDecorator}
{fieldName}{nullableSymbol}: {fieldType};

// ç¤ºä¾‹ï¼š
/** ç”¨æˆ·çŠ¶æ€ */
@Column({ type: "enum", enum: UserStatus })
@IsEnum(UserStatus)
status: UserStatus;
```

### ğŸ“ DTO æ–‡ä»¶æ›´æ–°è§„åˆ™

#### DTO ç±»å‘½åçº¦å®š
- `{Entity}Dto` - åŸºç¡€æ•°æ®ä¼ è¾“å¯¹è±¡
- `Create{Entity}Dto` - åˆ›å»ºæ“ä½œ DTO
- `Update{Entity}Dto` - æ›´æ–°æ“ä½œ DTO
- `{Entity}PageFilterDto` - åˆ†é¡µè¿‡æ»¤å™¨ DTO
- `{Entity}ListFilterDto` - åˆ—è¡¨è¿‡æ»¤å™¨ DTO

#### DTO å­—æ®µç”Ÿæˆæ¨¡æ¿
```typescript
/** {description} */
{fieldName}{nullableSymbol}: {fieldType};
```

### ğŸ¯ VO æ¥å£æ›´æ–°è§„åˆ™

#### VO æ¥å£å‘½åçº¦å®š
- `{Entity}Vo` - åŸºç¡€å€¼å¯¹è±¡æ¥å£
- `{Entity}ModelVo` - æ¨¡å‹å€¼å¯¹è±¡æ¥å£

#### VO å­—æ®µç”Ÿæˆæ¨¡æ¿
```typescript
/** {description} */
{fieldName}{nullableSymbol}: {fieldType};
```

### ğŸ”„ Mapper æ–‡ä»¶æ›´æ–°è§„åˆ™

#### Mapper æ–¹æ³•æ›´æ–°ç‚¹
1. **entityToModelDto æ–¹æ³•** - å®ä½“è½¬æ¨¡å‹ DTO
```typescript
dto.{fieldName} = entity.{fieldName};
```

2. **dtoToItemVo æ–¹æ³•** - DTO è½¬å€¼å¯¹è±¡
```typescript
{fieldName}: dto.{fieldName},
```

### âš¡ å­—æ®µç±»å‹å¤„ç†è§„åˆ™

#### å¯ç©ºå­—æ®µå¤„ç†
- å¦‚æœ `isNullable` ä¸º `true`ï¼š
  - TypeScript ç±»å‹æ·»åŠ  `?` ç¬¦å·
  - Entity æ·»åŠ  `@IsOptional()` è£…é¥°å™¨
  - TypeORM Column æ·»åŠ  `{ nullable: true }` é€‰é¡¹

#### æšä¸¾ç±»å‹å¤„ç†
- å½“å­—æ®µç±»å‹ä¸º `enum` æ—¶ï¼š
  - éœ€è¦æä¾› `enumValues` æ•°ç»„
  - ç”Ÿæˆå¯¹åº”çš„æšä¸¾ç±»å‹å®šä¹‰
  - åœ¨è£…é¥°å™¨ä¸­å¼•ç”¨æšä¸¾ç±»å‹

#### æ•°ç»„ç±»å‹å¤„ç†
- ä½¿ç”¨ TypeORM çš„ `simple-array` ç±»å‹
- TypeScript ç±»å‹ä¸º `{baseType}[]`

### ğŸ“ æ–‡ä»¶æ’å…¥ä½ç½®è§„åˆ™

#### Entity æ–‡ä»¶
- åœ¨ç±»çš„æœ€åä¸€ä¸ª `}` ä¹‹å‰æ’å…¥æ–°å­—æ®µ

#### DTO æ–‡ä»¶
- åœ¨æ¯ä¸ª DTO ç±»çš„æœ€åä¸€ä¸ª `}` ä¹‹å‰æ’å…¥æ–°å­—æ®µ

#### VO æ¥å£
- åœ¨æ¯ä¸ªæ¥å£çš„æœ€åä¸€ä¸ª `}` ä¹‹å‰æ’å…¥æ–°å­—æ®µ

#### Mapper æ–‡ä»¶
- åœ¨ `entityToModelDto` æ–¹æ³•çš„ `return dto;` ä¹‹å‰æ’å…¥æ˜ å°„ä»£ç 
- åœ¨ `dtoToItemVo` æ–¹æ³•çš„ `return vo;` ä¹‹å‰æ’å…¥æ˜ å°„ä»£ç 

### ğŸ›¡ï¸ é”™è¯¯å¤„ç†è§„åˆ™

1. **å­—æ®µéªŒè¯**
   - å­—æ®µåç§°ä¸èƒ½ä¸ºç©º
   - å­—æ®µæè¿°ä¸èƒ½ä¸ºç©º
   - æšä¸¾ç±»å‹å¿…é¡»æä¾›æšä¸¾å€¼
2. **æ–‡ä»¶æ£€æŸ¥**
   - ç¡®ä¿ç›®æ ‡æ–‡ä»¶å­˜åœ¨
   - å¤‡ä»½é‡è¦æ–‡ä»¶ï¼ˆå»ºè®®ï¼‰

3. **ç±»å‹å®‰å…¨**
   - ä½¿ç”¨ TypeScript ä¸¥æ ¼ç±»å‹æ£€æŸ¥
   - ç¡®ä¿ç”Ÿæˆçš„ä»£ç ç¬¦åˆé¡¹ç›®è§„èŒƒ

### ğŸ¨ ä»£ç é£æ ¼è§„åˆ™

1. **æ³¨é‡Šæ ¼å¼**
   - ä½¿ç”¨ JSDoc é£æ ¼çš„å­—æ®µæè¿°æ³¨é‡Š
   - æ ¼å¼ï¼š`/** {description} */`

2. **ç¼©è¿›å’Œæ ¼å¼**
   - ä½¿ç”¨ 2 ç©ºæ ¼ç¼©è¿›
   - ä¿æŒä¸ç°æœ‰ä»£ç é£æ ¼ä¸€è‡´

3. **å‘½åè§„èŒƒ**
   - å­—æ®µåä½¿ç”¨ camelCase
   - ç±»å‹åä½¿ç”¨ PascalCase
   - æšä¸¾å€¼ä½¿ç”¨ UPPER_CASE æˆ– camelCase
